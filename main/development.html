

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Development &mdash; demes 0.1.0a4.dev27 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/jupyter-sphinx.css" type="text/css" />
  <link rel="stylesheet" href="_static/thebelab.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/thebelab-helper.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Changelog" href="changelog.html" />
    <link rel="prev" title="Conversion functions" href="convert.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> demes
          

          
          </a>

          
            
            
              <div class="version">
                0.1.0a4.dev27
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="convert.html">Conversion functions</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Development</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="#continuous-integration-ci">Continuous integration (CI)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#lint-checks">Lint checks</a></li>
<li class="toctree-l2"><a class="reference internal" href="#test-suite">Test suite</a></li>
<li class="toctree-l2"><a class="reference internal" href="#building-the-documentation">Building the documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#releasing-a-new-version">Releasing a new version</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">demes</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Development</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/development.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="development">
<span id="sec-development"></span><h1>Development<a class="headerlink" href="#development" title="Permalink to this headline">¬∂</a></h1>
<p>We welcome all contributors! Contributions to <code class="docutils literal notranslate"><span class="pre">demes</span></code> typically take the form
of ‚Äúpull requests‚Äù against our <a class="reference external" href="https://github.com/popsim-consortium/demes-python">git repository</a>.</p>
<div class="section" id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¬∂</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">Demes</span></code> aims to have minimal dependencies when used as a library by other
projects. However, additional dependencies are required during development, as
developers regularly run the test suite, build the documentation, and assess
whether their code changes conform to style guidelines. The <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code>
file in the top-level folder lists all development dependencies, which can
be installed using <code class="docutils literal notranslate"><span class="pre">pip</span></code>. In the following documentation, we assume the reader
has cloned the source repository and installed the developer requirements as
follows.</p>
<blockquote>
<div><div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># Clone the repository.</span>
git clone https://github.com/popsim-consortium/demes-python.git
<span class="nb">cd</span> demes
<span class="c1"># Install the developer dependencies.</span>
python -m pip install -r requirements.txt
<span class="c1"># Generate the version string from the most recent git tag/commit.</span>
python setup.py build
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Non-developer requirements are listed in the <code class="docutils literal notranslate"><span class="pre">install_requires</span></code> section
of the <code class="docutils literal notranslate"><span class="pre">setup.cfg</span></code> file in the top-level folder of the sources.</p>
</div>
</div></blockquote>
</div>
<div class="section" id="continuous-integration-ci">
<h2>Continuous integration (CI)<a class="headerlink" href="#continuous-integration-ci" title="Permalink to this headline">¬∂</a></h2>
<p>After a pull request is submitted, an automated process known as
<em>continuous integration</em> (CI) will:</p>
<blockquote>
<div><ul class="simple">
<li><p>assess if the proposed changes conform to style guidelines (known as <em>lint</em> checks),</p></li>
<li><p>run the test suite,</p></li>
<li><p>and build the documentation.</p></li>
</ul>
</div></blockquote>
<p>The CI process uses
<a class="reference external" href="https://docs.github.com/en/free-pro-team&#64;latest/actions">GitHub Actions</a>
and the configuration files detailing how these are run can be found under the
<code class="docutils literal notranslate"><span class="pre">.github/workflows/</span></code> folder of the sources.</p>
</div>
<div class="section" id="lint-checks">
<h2>Lint checks<a class="headerlink" href="#lint-checks" title="Permalink to this headline">¬∂</a></h2>
<p>The following tools are run during the linting process:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="https://black.readthedocs.io/">black</a>, a code formatter
(code is only checked during CI, not reformatted),</p></li>
<li><p><a class="reference external" href="https://flake8.pycqa.org/">flake8</a>,
a <a class="reference external" href="https://www.python.org/dev/peps/pep-0008/">PEP8</a> code-style checker,</p></li>
<li><p><a class="reference external" href="http://mypy-lang.org/">mypy</a>, a static type checker.</p></li>
</ul>
</div></blockquote>
<p>Each of these tools can also be run manually from the top-level folder of the
sources. The <code class="docutils literal notranslate"><span class="pre">setup.cfg</span></code> file includes some project-specific configuration
for each of these tools, so running them from the command line should match
the behaviour of the CI checks.</p>
<p>For example, to reformat the code with <code class="docutils literal notranslate"><span class="pre">black</span></code> after making changes to the
<code class="docutils literal notranslate"><span class="pre">demes/demes.py</span></code> file (command output shown as comments):</p>
<blockquote>
<div><div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>black .
<span class="c1"># reformatted /home/grg/src/demes/demes/demes.py</span>
<span class="c1"># All done! ‚ú® üç∞ ‚ú®</span>
<span class="c1"># 1 file reformatted, 14 files left unchanged.</span>
</pre></div>
</div>
</div></blockquote>
<p>Similarly, one can check conformance to PEP8 style guidelines by running
<code class="docutils literal notranslate"><span class="pre">flake8</span></code> (without parameters), and check type annotations by running
<code class="docutils literal notranslate"><span class="pre">mypy</span></code> (also without parameters).</p>
</div>
<div class="section" id="test-suite">
<h2>Test suite<a class="headerlink" href="#test-suite" title="Permalink to this headline">¬∂</a></h2>
<p>A suite of tests is included in the <code class="docutils literal notranslate"><span class="pre">tests/</span></code> folder.
The CI process uses the <code class="docutils literal notranslate"><span class="pre">pytest</span></code> tool to run the tests, which can also be run
manually from the top-level folder of the sources.</p>
<blockquote>
<div><div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>python -m pytest -v tests --cov<span class="o">=</span>demes --cov-report<span class="o">=</span>term-missing
</pre></div>
</div>
</div></blockquote>
<p>This will produce lots of output, indicating which tests passed, and which
failed (if any). There may also be warnings. Any warnings that are triggered
by code in <code class="docutils literal notranslate"><span class="pre">demes</span></code> (rather than third-party libraries), should be fixed.</p>
<p>It is expected that new code contributions will be tested by the introduction
of new tests in the test suite. While we don‚Äôt currently have any strict
requirements for code coverage, more is better. Furthermore, we encourage
contributions that improve, or expand on, the existing suite of tests.</p>
</div>
<div class="section" id="building-the-documentation">
<h2>Building the documentation<a class="headerlink" href="#building-the-documentation" title="Permalink to this headline">¬∂</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">demes</span></code> documentation is built with <a class="reference external" href="https://www.sphinx-doc.org/">sphinx</a>.
Much of the documentation is under the <code class="docutils literal notranslate"><span class="pre">docs/</span></code> folder, written in the
<a class="reference external" href="https://docutils.sourceforge.io/docs/ref/rst/restructuredtext.html">reStructuredText</a>
format (the <code class="docutils literal notranslate"><span class="pre">.rst</span></code> files), and is configured with the <code class="docutils literal notranslate"><span class="pre">docs/conf.py</span></code> file.
In contrast, the API documentation is automatically generated from ‚Äúdocstrings‚Äù
in the python code. To build the documentation locally, run <code class="docutils literal notranslate"><span class="pre">make</span></code> from the
<code class="docutils literal notranslate"><span class="pre">docs/</span></code> folder.</p>
<blockquote>
<div><div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> docs
make
</pre></div>
</div>
</div></blockquote>
<p>If this was successful, the generated documentation can be viewed in a browser
by navigating to the <code class="docutils literal notranslate"><span class="pre">docs/_build/html/index.html</span></code> file. It is expected that
new code contributions will be accompanied by relevant documentation (e.g. a
new function will include a docstring).</p>
<p>We strongly encourage contributions that improve the <code class="docutils literal notranslate"><span class="pre">demes</span></code> documentation,
such as fixing typos and grammatical errors, or making the documentation
clearer and/or more accessible.</p>
</div>
<div class="section" id="releasing-a-new-version">
<h2>Releasing a new version<a class="headerlink" href="#releasing-a-new-version" title="Permalink to this headline">¬∂</a></h2>
<p>See tskit docs on making a release:
<a class="reference external" href="https://tskit.readthedocs.io/en/latest/development.html#releasing-a-new-version">https://tskit.readthedocs.io/en/latest/development.html#releasing-a-new-version</a></p>
<p>Prepare for the release by updating the <code class="docutils literal notranslate"><span class="pre">CHANGELOG.rst</span></code>. The version here
should have the format MAJOR.MINOR.PATCH, or for a beta release
MAJOR.MINOR.PATCHbX, e.g. 1.0.0b1. Commit the changes to the changelog;
make pull request; merge.</p>
<dl class="simple">
<dt>Tag release.</dt><dd><ul class="simple">
<li><p>E.g. <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">tag</span> <span class="pre">0.1.0</span></code></p></li>
</ul>
</dd>
<dt>Build distribution files, and test on testpypi.</dt><dd><ul class="simple">
<li><p>See <a class="reference external" href="https://packaging.python.org/tutorials/packaging-projects/#generating-distribution-archives">https://packaging.python.org/tutorials/packaging-projects/#generating-distribution-archives</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">pip</span> <span class="pre">install</span> <span class="pre">--upgrade</span> <span class="pre">build</span> <span class="pre">twine</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">build</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">twine</span> <span class="pre">check</span> <span class="pre">dist/*</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">twine</span> <span class="pre">upload</span> <span class="pre">--repository</span> <span class="pre">testpypi</span> <span class="pre">dist/*</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">uninstall</span> <span class="pre">demes</span></code></p></li>
<li><p>Check it installs: <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">--upgrade</span> <span class="pre">--pre</span> <span class="pre">--index-url</span> <span class="pre">https://test.pypi.org/simple/</span> <span class="pre">demes</span></code>.</p></li>
</ul>
</dd>
<dt>Upload to pypi.</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">twine</span> <span class="pre">upload</span> <span class="pre">--repository</span> <span class="pre">pypi</span> <span class="pre">dist/*</span></code></p></li>
<li><p>Check it installs: <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">demes</span> <span class="pre">--upgrade</span> <span class="pre">--pre</span></code>.</p></li>
</ul>
</dd>
<dt>Push release.</dt><dd><ul class="simple">
<li><p>E.g. <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">push</span> <span class="pre">origin</span> <span class="pre">0.1.0</span></code></p></li>
<li><p>Create a release in the GitHub UI, based on the tag that was pushed.
Running <code class="docutils literal notranslate"><span class="pre">docs/convert_changelog.py</span></code> will format the changelog for GitHub
(script shamelessly stolen from tskit).</p></li>
</ul>
</dd>
</dl>
<p>Finally, update the changelog to start a section for the next release cycle.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="changelog.html" class="btn btn-neutral float-right" title="Changelog" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="convert.html" class="btn btn-neutral float-left" title="Conversion functions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, PopSim Consortium.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>