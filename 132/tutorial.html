

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Tutorial &mdash; demes 0.1.dev1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/jupyter-sphinx.css" type="text/css" />
  <link rel="stylesheet" href="_static/thebelab.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script src="_static/thebelab-helper.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Gallery" href="gallery.html" />
    <link rel="prev" title="Installation" href="installation.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> demes
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#defining-a-demography-in-yaml">Defining a demography in YAML</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#time-units-and-conventions">Time units and conventions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#defining-epochs">Defining epochs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#multiple-demes">Multiple demes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#population-branches-and-splits">Population branches and splits</a></li>
<li class="toctree-l3"><a class="reference internal" href="#continuous-migration">Continuous migration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pulse-migration-events">Pulse migration events</a></li>
<li class="toctree-l3"><a class="reference internal" href="#admixture-events">Admixture events</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#using-the-python-api">Using the Python API</a></li>
<li class="toctree-l2"><a class="reference internal" href="#deme-attributes">Deme attributes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="gallery.html">Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="convert.html">Conversion functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="schema.html">Schema</a></li>
<li class="toctree-l1"><a class="reference internal" href="development.html">Development</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">demes</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Tutorial</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/tutorial.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="tutorial">
<span id="sec-tutorial"></span><h1>Tutorial<a class="headerlink" href="#tutorial" title="Permalink to this headline">¶</a></h1>
<div class="section" id="defining-a-demography-in-yaml">
<span id="sec-tutorial-yaml-demography"></span><h2>Defining a demography in YAML<a class="headerlink" href="#defining-a-demography-in-yaml" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>What is YAML? And why is it appropriate for this task?</p>
</div>
<p>A demographic model description contains enough information about
the demes (or populations) present, their attributes and relationships,
and general demographic features (e.g. rate of self-fertilization) to
be able to unambiguously recreate and simulate under that demograhy.
Thus, a <code class="docutils literal notranslate"><span class="pre">demes</span></code> model contains “global” attributes, specified demes, and
migration rates and mass migration events between demes.</p>
<p>A minimal YAML description of a demography requires the following:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">description</span></code>: A description or identification of the demographic model.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">time_units</span></code>: The time units for any demographic events.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">demes</span></code>: a list of (at least one) deme, which must include information
about its initial size.</p></li>
</ol>
<p>For example, the simplest demography of a single population of constant
size (say, <span class="math notranslate nohighlight">\(N_e=1000\)</span>) would be written as</p>
<div class="literal-block-wrapper docutils container" id="minimal-demography">
<div class="code-block-caption"><span class="caption-text">A minimal YAML demography.</span><a class="headerlink" href="#minimal-demography" title="Permalink to this code">¶</a></div>
<div class="highlight-yaml notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Minimal deme graph. Single population of constant size.</span>
<span class="nt">time_units</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">generations</span>
<span class="nt">demes</span><span class="p">:</span>
  <span class="nt">constant_size_deme</span><span class="p">:</span>
    <span class="nt">initial_size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1000</span>
</pre></div>
</td></tr></table></div>
</div>
<p>Since we did not specify a <code class="docutils literal notranslate"><span class="pre">start_time</span></code> or <code class="docutils literal notranslate"><span class="pre">end_time</span></code> of the deme’s
existence, by defult it spans all time from time <span class="math notranslate nohighlight">\(\infty\)</span> in the past
to 0 (“now”).  See the <a class="reference internal" href="#sec-time-units"><span class="std std-ref">next section</span></a> that describes
time conventions in a <code class="docutils literal notranslate"><span class="pre">Graph</span></code>.</p>
<div class="section" id="time-units-and-conventions">
<span id="sec-time-units"></span><h3>Time units and conventions<a class="headerlink" href="#time-units-and-conventions" title="Permalink to this headline">¶</a></h3>
<p>Time flows from the past to the present. In population genetics terms, we
are in the <cite>forward-in-time</cite> setting (as opposed to the <cite>backward-in-time</cite>
setting of the coalescent). This means that when specifying migration events,
we define <cite>source</cite> and <cite>destination</cite> demes to be the demes that individuals
are moving <cite>from</cite> and <cite>to</cite>, respectively, forwards in time.</p>
<p>We measure time in <code class="docutils literal notranslate"><span class="pre">time_units</span></code> in the past, so that <code class="docutils literal notranslate"><span class="pre">time</span> <span class="pre">=</span> <span class="pre">0</span></code> implies
<cite>now</cite> (or rather, the final generation of the simulation). Thus, time counts
down from as we advance from one generation from the next.</p>
<p>When defining a <code class="docutils literal notranslate"><span class="pre">Graph</span></code> in YAML, we must specify the <code class="docutils literal notranslate"><span class="pre">time_units</span></code>.
Typically, we set <code class="docutils literal notranslate"><span class="pre">time_units:</span> <span class="pre">generations</span></code>, so that all times are specified
in generations in the past. However, we allow the flexibility to use any unit
of time, such as years, weeks, thousands of years, etc. In the case that the
time units are not in generations, we must also specify the <code class="docutils literal notranslate"><span class="pre">generation_time</span></code>
of the species we are modelling. For example, a human demography specified in
years could be written as</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">A human demographic model.</span>
<span class="nt">time_units</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">years</span>
<span class="nt">generation_time</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">29</span>
<span class="nt">demes</span><span class="p">:</span>
  <span class="l l-Scalar l-Scalar-Plain">...</span>
</pre></div>
</div>
</div>
<div class="section" id="defining-epochs">
<h3>Defining epochs<a class="headerlink" href="#defining-epochs" title="Permalink to this headline">¶</a></h3>
<p>A <code class="docutils literal notranslate"><span class="pre">deme</span></code> can be made to have more interesting demographic history, such as
size changes or non-constant size functions. This is done by defining
<code class="docutils literal notranslate"><span class="pre">epochs</span></code> that span the time that a deme exists. When defining an epoch,
we specify its <code class="docutils literal notranslate"><span class="pre">start_time</span></code> and <code class="docutils literal notranslate"><span class="pre">end_time</span></code>, along with its <code class="docutils literal notranslate"><span class="pre">initial_size</span></code>
and <code class="docutils literal notranslate"><span class="pre">final_size</span></code> (or just <code class="docutils literal notranslate"><span class="pre">initial_size</span></code> if the population size is constant
over that epoch).</p>
<p>For example, the same minimal demography <a class="reference internal" href="#minimal-demography"><span class="std std-ref">above</span></a>
could be written by specifying a single epoch over the entire time span of
the deme:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">demes</span><span class="p">:</span>
  <span class="nt">constant_size_deme</span><span class="p">:</span>
    <span class="nt">epochs</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">initial_size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1000</span>
      <span class="nt">end_time</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
</pre></div>
</div>
<p>By default, the first listed <code class="docutils literal notranslate"><span class="pre">epoch</span></code> has a <code class="docutils literal notranslate"><span class="pre">start_time</span></code> of <span class="math notranslate nohighlight">\(\infty\)</span>
if it is not specified.</p>
<p>To allow for size changes and varying size functions over different epochs,
we can simply specify additional epochs. Typically, we only need to define
the <code class="docutils literal notranslate"><span class="pre">end_time</span></code> of each epoch, as the <code class="docutils literal notranslate"><span class="pre">start_time</span></code> is automatically set to the
<code class="docutils literal notranslate"><span class="pre">end_time</span></code> of the previous epoch. For this reason, <code class="docutils literal notranslate"><span class="pre">epochs</span></code> need to be listed
in order, from most ancient to most recent.</p>
<div class="literal-block-wrapper docutils container" id="one-pop-demography">
<div class="code-block-caption"><span class="caption-text">A single-population demography with multiple epochs.</span><a class="headerlink" href="#one-pop-demography" title="Permalink to this code">¶</a></div>
<div class="highlight-yaml notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">A single population with multiple epochs that have varying</span>
  <span class="l l-Scalar l-Scalar-Plain">sizes and size functions.</span>
<span class="nt">time_units</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">years</span>
<span class="nt">generation_time</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">25</span>
<span class="nt">demes</span><span class="p">:</span>
  <span class="nt">our_population</span><span class="p">:</span>
    <span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">A deme with multiple epochs.</span>
    <span class="nt">initial_size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">10000</span>
    <span class="nt">epochs</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">initial_size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">10000</span>
      <span class="nt">end_time</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">250000</span>
    <span class="p p-Indicator">-</span> <span class="nt">initial_size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">20000</span>
      <span class="nt">end_time</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">60000</span>
    <span class="p p-Indicator">-</span> <span class="nt">initial_size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1500</span>
      <span class="nt">end_time</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">30000</span>
    <span class="p p-Indicator">-</span> <span class="nt">final_size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">40000</span>
      <span class="nt">end_time</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
</pre></div>
</td></tr></table></div>
</div>
<p>We also see, again, that for constant size epochs we only need to specify
the <code class="docutils literal notranslate"><span class="pre">initial_size</span></code>, and if no <code class="docutils literal notranslate"><span class="pre">initial_size</span></code> is given, the <code class="docutils literal notranslate"><span class="pre">epoch</span></code> inherits
the <code class="docutils literal notranslate"><span class="pre">final_size</span></code> of the previous epoch.</p>
<p>In the previous example, we have a <code class="docutils literal notranslate"><span class="pre">deme</span></code> that expands from an effective population
size of 10,000 to 20,000 250 thousand years ago, goes through a bottleneck
between 60 and 30 thousand years ago, and then expontially grows from the
bottleneck size of 1,500 to 40,000 from 30 thousand years ago until present
time.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If no <code class="docutils literal notranslate"><span class="pre">size_function</span></code> is given, when the <code class="docutils literal notranslate"><span class="pre">initial_size</span></code> and <code class="docutils literal notranslate"><span class="pre">final_size</span></code>
are different, the default size function is exponential. However, other
size functions, such as linear, are permitted and can be specified.</p>
</div>
</div>
<div class="section" id="multiple-demes">
<h3>Multiple demes<a class="headerlink" href="#multiple-demes" title="Permalink to this headline">¶</a></h3>
<p>Additional demes are specified by listing each deme under <code class="docutils literal notranslate"><span class="pre">demes</span></code>. For example,
if we have two constant size demes that both exist for all time and never
interact (for illustration, not realism), we could write:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">demes</span><span class="p">:</span>
  <span class="nt">deme1</span><span class="p">:</span>
    <span class="nt">initial_size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1000</span>
  <span class="nt">deme2</span><span class="p">:</span>
    <span class="nt">initial_size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">2000</span>
</pre></div>
</div>
</div>
<div class="section" id="population-branches-and-splits">
<h3>Population branches and splits<a class="headerlink" href="#population-branches-and-splits" title="Permalink to this headline">¶</a></h3>
<p>It’s more interesting if our demes interact. First, we could have a deme that
branches off from a parental deme, and the parent continues to exist. For the child
deme, we would specify that its <code class="docutils literal notranslate"><span class="pre">ancestor</span></code> is its parental deme. For example,</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">demes</span><span class="p">:</span>
  <span class="nt">parental_deme</span><span class="p">:</span>
    <span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">The parental deme, that exists for all time.</span>
    <span class="nt">initial_size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1000</span>
  <span class="nt">child_deme</span><span class="p">:</span>
    <span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">The child deme, that exists from the branching time.</span>
    <span class="nt">ancestors</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">parental_deme</span>
    <span class="nt">initial_size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">500</span>
    <span class="nt">start_time</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">100</span>
</pre></div>
</div>
<p>Here, the child deme split off from the parental deme 100 time units ago,
and both demes continue to exist until present time.</p>
<p>Alternatively, a deme could end at some time in the past, and give rise to
two or more children demes. In this case, we specify the <code class="docutils literal notranslate"><span class="pre">end_time</span></code> of the
parental deme, and each child deme inherits that <code class="docutils literal notranslate"><span class="pre">end_time</span></code> as their
<code class="docutils literal notranslate"><span class="pre">start_time</span></code>. For example, a single deme that splits into three demes
is written as</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">demes</span><span class="p">:</span>
  <span class="nt">parental_deme</span><span class="p">:</span>
    <span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">The parental deme, that splits into three demes.</span>
    <span class="nt">initial_size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1000</span>
    <span class="nt">end_time</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">200</span>
  <span class="nt">child1</span><span class="p">:</span>
    <span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">The first child deme.</span>
    <span class="nt">ancestors</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">parental_deme</span>
    <span class="nt">initial_size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">500</span>
  <span class="nt">child2</span><span class="p">:</span>
    <span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">The second child deme.</span>
    <span class="nt">ancestors</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">parental_deme</span>
    <span class="nt">initial_size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">800</span>
  <span class="nt">child3</span><span class="p">:</span>
    <span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">The third child deme.</span>
    <span class="nt">ancestors</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">parental_deme</span>
    <span class="nt">initial_size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">600</span>
</pre></div>
</div>
<p>Here, the parental deme exists until time 200, and each child deme exists
from time 200 to present time.</p>
<div class="literal-block-wrapper docutils container" id="isolation-with-migration">
<div class="code-block-caption"><span class="caption-text">A two-population isolation-with-migration model.</span><a class="headerlink" href="#isolation-with-migration" title="Permalink to this code">¶</a></div>
<div class="highlight-yaml notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Isolation with migration model. A single deme splits into</span>
  <span class="l l-Scalar l-Scalar-Plain">two demes, both grow exponentially with symmetric continuous migration.</span>
<span class="nt">time_units</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">generations</span>
<span class="nt">demes</span><span class="p">:</span>
  <span class="nt">root</span><span class="p">:</span>
    <span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Parental deme</span>
    <span class="nt">initial_size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">10000</span>
    <span class="nt">end_time</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1200</span>
  <span class="nt">deme1</span><span class="p">:</span>
    <span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">First child deme</span>
    <span class="nt">ancestors</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">root</span>
    <span class="nt">initial_size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">2000</span>
    <span class="nt">final_size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">30000</span>
  <span class="nt">deme2</span><span class="p">:</span>
    <span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Second child deme</span>
    <span class="nt">ancestors</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">root</span>
    <span class="nt">initial_size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">8000</span>
    <span class="nt">final_size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">15000</span>
<span class="nt">migrations</span><span class="p">:</span>
  <span class="nt">symmetric</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">demes</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">deme1, deme2</span>
      <span class="nt">rate</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">3e-4</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="continuous-migration">
<h3>Continuous migration<a class="headerlink" href="#continuous-migration" title="Permalink to this headline">¶</a></h3>
<p>As suggested by the <a class="reference internal" href="#isolation-with-migration"><span class="std std-ref">isolation-with-migration</span></a>
model, continuous migration is easy to include. Continuous migration rates
are specified under <code class="docutils literal notranslate"><span class="pre">migrations</span></code>, and can be either <code class="docutils literal notranslate"><span class="pre">symmetric</span></code> or
<code class="docutils literal notranslate"><span class="pre">asymmetric</span></code>. For <code class="docutils literal notranslate"><span class="pre">symmetric</span></code> migration, we need only specify the list of
demes involved and the migration rate. <strong>Note that migration rates are always
given in units of per-generation</strong>, even if the <code class="docutils literal notranslate"><span class="pre">time_units</span></code> are not in
generations.</p>
<p>For <code class="docutils literal notranslate"><span class="pre">asymmetric</span></code> migration, we specify the <code class="docutils literal notranslate"><span class="pre">source</span></code> and the <code class="docutils literal notranslate"><span class="pre">dest</span></code> (that is,
where migrants are coming from and going to, resp.), instead of a list of
demes. Remember that <code class="docutils literal notranslate"><span class="pre">source</span></code> and <code class="docutils literal notranslate"><span class="pre">dest</span></code> are viewed in the forward-in-time
convention.</p>
<p>By default, migration rates are valid for the entire interval of time that
two demes overlap. If there are periods of time that only one of the specified
demes are present, that migration rate is ingored during that time.
Optionally, we can specify a <code class="docutils literal notranslate"><span class="pre">start_time</span></code> and an <code class="docutils literal notranslate"><span class="pre">end_time</span></code> for continuous
migration, much like we specify <code class="docutils literal notranslate"><span class="pre">epoch</span></code> intervals.</p>
<p>For example, this snippet specifies two demes with changing migration rates
over time:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">demes</span><span class="p">:</span>
  <span class="nt">deme1</span><span class="p">:</span>
    <span class="nt">initial_size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1000</span>
  <span class="nt">deme2</span><span class="p">:</span>
    <span class="nt">initial_size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1000</span>
<span class="nt">migrations</span><span class="p">:</span>
  <span class="nt">symmetric</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">demes</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">deme1, deme2</span>
      <span class="nt">rate</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1e-4</span>
      <span class="nt">start_time</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">800</span>
      <span class="nt">end_time</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">500</span>
  <span class="nt">asymmetric</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">source</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">deme1</span>
      <span class="nt">dest</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">deme2</span>
      <span class="nt">rate</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">5e-4</span>
      <span class="nt">start_time</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">400</span>
      <span class="nt">end_time</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">200</span>
    <span class="p p-Indicator">-</span> <span class="nt">source</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">deme2</span>
      <span class="nt">dest</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">deme1</span>
      <span class="nt">rate</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">2e-4</span>
      <span class="nt">start_time</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">300</span>
      <span class="nt">end_time</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
</pre></div>
</div>
</div>
<div class="section" id="pulse-migration-events">
<h3>Pulse migration events<a class="headerlink" href="#pulse-migration-events" title="Permalink to this headline">¶</a></h3>
<p>Another commonly modelled process for the exchange of migrants is
a “pulse” migration event (or “mass migration” event), which is the
instantanous movement of individuals from one deme that replace
some proportion of individuals in the second deme. Such events are
specified by the <code class="docutils literal notranslate"><span class="pre">time</span></code> of the event, the <code class="docutils literal notranslate"><span class="pre">source</span></code> (where migrants
are moved from), the <code class="docutils literal notranslate"><span class="pre">dest</span></code> (where migrants are moved to), and the
<code class="docutils literal notranslate"><span class="pre">proportion</span></code> of the destination deme that is replaced.</p>
<p>Thus, pulse migrations are specified as</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">pulses</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">time</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">100</span>
    <span class="nt">source</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">deme_from</span>
    <span class="nt">dest</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">deme_to</span>
    <span class="nt">proportion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0.1</span>
</pre></div>
</div>
<p>Of course, for this to be a valid demographic event, the <code class="docutils literal notranslate"><span class="pre">proportion</span></code>
must be between 0 and 1, and both demes must exist at the specified
<code class="docutils literal notranslate"><span class="pre">time</span></code>.</p>
</div>
<div class="section" id="admixture-events">
<h3>Admixture events<a class="headerlink" href="#admixture-events" title="Permalink to this headline">¶</a></h3>
<p>Finally, a new deme can be formed through the merger or admixture of
two or more parental demes. The parental demes could continue to exist
beyond the time of admixture, or they could each end at that time, so
that the new deme is a complete merger of its parents.
<code class="docutils literal notranslate"><span class="pre">Demes</span></code> allows both cases - we only require that each parental deme
exists or has its <code class="docutils literal notranslate"><span class="pre">end_time</span></code> at the time of admixture.</p>
<p>To specify an admixture event, we specify the admixed deme’s <code class="docutils literal notranslate"><span class="pre">ancestors</span></code>
as a comma-separated list of parental demes, and their <code class="docutils literal notranslate"><span class="pre">proportions</span></code> as
a comma-separated list of admixture proportions from the parental demes.
<code class="docutils literal notranslate"><span class="pre">proportions</span></code> must sum to 1, and the length and order must match the
demes listed in <code class="docutils literal notranslate"><span class="pre">ancestors</span></code>.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">demes</span><span class="p">:</span>
  <span class="nt">parental1</span><span class="p">:</span>
    <span class="nt">initial_size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1000</span>
    <span class="nt">end_time</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">100</span>
  <span class="nt">parental2</span><span class="p">:</span>
    <span class="nt">initial_size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">2000</span>
    <span class="nt">end_time</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">100</span>
  <span class="nt">merged_deme</span><span class="p">:</span>
    <span class="nt">ancestors</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">parental1, parental2</span>
    <span class="nt">proportions</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0.7, 0.3</span>
    <span class="nt">initial_size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">3000</span>
    <span class="nt">final_size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">5000</span>
</pre></div>
</div>
<p>Here, two demes merge to form a single deme 100 time units ago, which
then grows exponentially from 3,000 to 5,000 at present time.</p>
<p>For a more complete example, the
<a class="reference internal" href="#browning-america"><span class="std std-ref">Browning et al. (2011)</span></a>  model of admixture
in the Americas includes three source demes that recently admix, and all
demes persist until present time.</p>
<div class="literal-block-wrapper docutils container" id="browning-america">
<div class="code-block-caption"><span class="caption-text">The Browning et al. (2011) American admixture model.</span><a class="headerlink" href="#browning-america" title="Permalink to this code">¶</a></div>
<div class="highlight-yaml notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">The Browning et al. (2011) model of admixture in the Americas.</span>
<span class="nt">doi</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">10.1371/journal.pgen.1007385</span>
<span class="nt">time_units</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">generations</span>
<span class="nt">generation_time</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">25</span>
<span class="nt">demes</span><span class="p">:</span>
  <span class="nt">ancestral</span><span class="p">:</span>
    <span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Equilibrium/root population</span>
    <span class="nt">end_time</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">5920</span>
    <span class="nt">initial_size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">7310</span>
  <span class="nt">AMH</span><span class="p">:</span>
    <span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Anatomically modern humans</span>
    <span class="nt">ancestors</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ancestral</span>
    <span class="nt">end_time</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">2040</span>
    <span class="nt">initial_size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">14474</span>
  <span class="nt">OOA</span><span class="p">:</span>
    <span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Bottleneck out-of-Africa population</span>
    <span class="nt">ancestors</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AMH</span>
    <span class="nt">end_time</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">920</span>
    <span class="nt">initial_size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1861</span>
  <span class="nt">AFR</span><span class="p">:</span>
    <span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">African population</span>
    <span class="nt">ancestors</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AMH</span>
    <span class="nt">initial_size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">14474</span>
  <span class="nt">EUR</span><span class="p">:</span>
    <span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">European population</span>
    <span class="nt">ancestors</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">OOA</span>
    <span class="nt">initial_size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1000</span>
    <span class="nt">final_size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">34039</span>
  <span class="nt">EAS</span><span class="p">:</span>
    <span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">East Asian population</span>
    <span class="nt">ancestors</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">OOA</span>
    <span class="nt">initial_size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">510</span>
    <span class="nt">final_size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">45852</span>
  <span class="nt">ADMIX</span><span class="p">:</span>
    <span class="nt">description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Admixed American population</span>
    <span class="nt">ancestors</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AFR, EUR, EAS</span>
    <span class="nt">proportions</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0.167, 0.333, 0.5</span>
    <span class="nt">start_time</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">12</span>
    <span class="nt">initial_size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">30000</span>
    <span class="nt">final_size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">54664</span>
<span class="nt">migrations</span><span class="p">:</span>
  <span class="nt">symmetric</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">demes</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AFR, OOA</span>
    <span class="nt">rate</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">15e-5</span>
  <span class="p p-Indicator">-</span> <span class="nt">demes</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AFR, EUR</span>
    <span class="nt">rate</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">2.5e-5</span>
  <span class="p p-Indicator">-</span> <span class="nt">demes</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AFR, EAS</span>
    <span class="nt">rate</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0.78e-5</span>
  <span class="p p-Indicator">-</span> <span class="nt">demes</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">EUR, EAS</span>
    <span class="nt">rate</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">3.11e-5</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>A note on model robustness and ambiguity</strong></p>
<p>This is the note to be written.</p>
</div>
<p>Additional examples and inspiration can be found in our
<a class="reference internal" href="gallery.html#sec-gallery"><span class="std std-ref">gallery of examples</span></a>.</p>
</div>
</div>
<div class="section" id="using-the-python-api">
<span id="sec-tutorial-python-api"></span><h2>Using the Python API<a class="headerlink" href="#using-the-python-api" title="Permalink to this headline">¶</a></h2>
<p>Working directly with the Python API.</p>
</div>
<div class="section" id="deme-attributes">
<span id="sec-tutorial-attributes"></span><h2>Deme attributes<a class="headerlink" href="#deme-attributes" title="Permalink to this headline">¶</a></h2>
<p>Additional features: selfing, cloning, migration rate changes, …</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="gallery.html" class="btn btn-neutral float-right" title="Gallery" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="installation.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, PopSim Consortium

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>